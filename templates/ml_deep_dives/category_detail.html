{% extends 'base.html' %}

{% block title %}{{ category.name }} - ML Deep Dives{% endblock %}

{% block content %}
<div class="bg-gray-50">
    <!-- Header Section with Curves -->
    <div class="relative bg-gradient-to-br from-indigo-800 via-purple-800 to-pink-800 text-white overflow-hidden">
        <div class="absolute inset-0">
            <div class="absolute top-0 left-0 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse"></div>
            <div class="absolute bottom-0 right-0 w-72 h-72 bg-yellow-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse" style="animation-delay: 2s;"></div>
        </div>
        <div class="relative z-10 max-w-7xl mx-auto px-4 py-16">
            <!-- Breadcrumbs -->
            <nav class="flex items-center space-x-2 text-sm text-purple-200 mb-6">
                <a href="{% url 'home' %}" class="hover:text-white transition-colors">Home</a>
                <i class="fas fa-chevron-right text-purple-300 fa-xs"></i>
                <a href="{% url 'ml_deep_dives:category_list' %}" class="hover:text-white transition-colors">ML Deep Dives</a>
                <i class="fas fa-chevron-right text-purple-300 fa-xs"></i>
                <span class="text-white font-semibold">{{ category.name }}</span>
            </nav>
            
            <div class="flex flex-col md:flex-row items-start md:items-center">
                <div class="w-20 h-20 bg-white/10 backdrop-blur-sm rounded-2xl flex items-center justify-center mr-6 mb-4 md:mb-0 flex-shrink-0">
                    <i class="{{ category.icon }} text-white text-3xl"></i>
                </div>
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold text-white">{{ category.name }}</h1>
                    {% if category.description %}
                    <p class="text-purple-200 text-xl mt-1 max-w-2xl">{{ category.description }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Curved Bottom -->
        <div class="absolute bottom-0 left-0 right-0">
            <svg viewBox="0 0 1200 120" preserveAspectRatio="none" class="w-full h-20">
                <path d="M0,0 C300,120 900,120 1200,0 L1200,120 L0,120 Z" fill="#f9fafb"></path>
            </svg>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- START: Corrected Sidebar -->
            <div class="w-full lg:w-1/4 lg:pr-8">
                <div class="bg-white rounded-2xl shadow-lg p-6 sticky top-28">
                    <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <i class="fas fa-list mr-3 text-indigo-600"></i>
                        Topics
                    </h3>
                    <nav class="space-y-2">
                        {% for c in categories %}
                        <div class="category-group">
                            <button class="w-full text-left p-3 rounded-lg hover:bg-opacity-80 transition-all duration-300 flex items-center justify-between group
                                {% if c.slug == category.slug %} bg-purple-50 text-purple-800 {% else %} text-gray-700 hover:bg-gray-100 {% endif %}" 
                                    onclick="toggleCategory('{{ c.slug }}')">
                                <span class="font-semibold flex items-center">
                                    <i class="{{ c.icon }} mr-2 w-5 text-center"></i>
                                    {{ c.name }}
                                </span>
                                <i class="fas fa-chevron-down text-gray-500 transition-transform duration-300 {% if c.slug == category.slug %} rotate-180 {% endif %}" id="{{ c.slug }}-icon"></i>
                            </button>
                            <div class="mt-2 ml-4 pl-4 border-l-2 border-purple-200 space-y-1 {% if c.slug != category.slug %} hidden {% endif %}" id="{{ c.slug }}-subtopics">
                                {% for topic in c.topics.all %}
                                <a href="{{ topic.get_absolute_url }}" class="block py-1 px-2 rounded text-sm text-gray-600 hover:bg-purple-100 hover:text-purple-800 transition-colors">
                                    {{ topic.title }}
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                    </nav>
                </div>
            </div>
            <!-- END: Corrected Sidebar -->

            <!-- Main Content -->
            <div class="w-full lg:w-3/4">
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <div class="p-8 border-b border-gray-200">
                        <h2 class="text-2xl font-bold text-gray-800">Topics in {{ category.name }}</h2>
                        <p class="mt-1 text-gray-600">Select a topic to start your deep dive.</p>
                    </div>
                    
                    <div class="p-6">
                        {% if topics %}
                        <div class="grid md:grid-cols-2 gap-6">
                            {% for topic in topics %}
                            <a href="{{ topic.get_absolute_url }}" 
                               class="group block p-6 rounded-2xl transition-all duration-300 transform hover:-translate-y-1
                                {% with slug=category.slug %}
                                    {% if slug == 'math' %} bg-gradient-to-br from-green-50 to-emerald-50 hover:shadow-xl hover:shadow-green-200 border border-green-100 {% endif %}
                                    {% if slug == 'libraries' %} bg-gradient-to-br from-blue-50 to-cyan-50 hover:shadow-xl hover:shadow-blue-200 border border-blue-100 {% endif %}
                                    {% if slug == 'ml' %} bg-gradient-to-br from-purple-50 to-indigo-50 hover:shadow-xl hover:shadow-purple-200 border border-purple-100 {% endif %}
                                    {% if slug == 'deep-learning' %} bg-gradient-to-br from-pink-50 to-rose-50 hover:shadow-xl hover:shadow-pink-200 border border-pink-100 {% endif %}
                                    {% if slug == 'nlp' %} bg-gradient-to-br from-orange-50 to-amber-50 hover:shadow-xl hover:shadow-orange-200 border border-orange-100 {% endif %}
                                {% endwith %}
                            ">
                                <div class="flex items-start justify-between mb-4">
                                    <h4 class="font-semibold text-lg transition-colors
                                        {% with slug=category.slug %}
                                            {% if slug == 'math' %} text-green-800 group-hover:text-green-900 {% endif %}
                                            {% if slug == 'libraries' %} text-blue-800 group-hover:text-blue-900 {% endif %}
                                            {% if slug == 'ml' %} text-purple-800 group-hover:text-purple-900 {% endif %}
                                            {% if slug == 'deep-learning' %} text-pink-800 group-hover:text-pink-900 {% endif %}
                                            {% if slug == 'nlp' %} text-orange-800 group-hover:text-orange-900 {% endif %}
                                        {% endwith %}
                                    ">{{ topic.title }}</h4>
                                    <i class="fas fa-arrow-right transition-all
                                        {% with slug=category.slug %}
                                            {% if slug == 'math' %} text-green-400 group-hover:text-green-600 {% endif %}
                                            {% if slug == 'libraries' %} text-blue-400 group-hover:text-blue-600 {% endif %}
                                            {% if slug == 'ml' %} text-purple-400 group-hover:text-purple-600 {% endif %}
                                            {% if slug == 'deep-learning' %} text-pink-400 group-hover:text-pink-600 {% endif %}
                                            {% if slug == 'nlp' %} text-orange-400 group-hover:text-orange-600 {% endif %}
                                        {% endwith %}
                                        group-hover:translate-x-1"></i>
                                </div>
                                <p class="text-sm mb-4
                                    {% with slug=category.slug %}
                                        {% if slug == 'math' %} text-green-700/80 {% endif %}
                                        {% if slug == 'libraries' %} text-blue-700/80 {% endif %}
                                        {% if slug == 'ml' %} text-purple-700/80 {% endif %}
                                        {% if slug == 'deep-learning' %} text-pink-700/80 {% endif %}
                                        {% if slug == 'nlp' %} text-orange-700/80 {% endif %}
                                    {% endwith %}
                                ">{{ topic.summary|truncatewords:20 }}</p>
                                <div class="flex items-center justify-between text-xs
                                    {% with slug=category.slug %}
                                        {% if slug == 'math' %} text-green-600/90 {% endif %}
                                        {% if slug == 'libraries' %} text-blue-600/90 {% endif %}
                                        {% if slug == 'ml' %} text-purple-600/90 {% endif %}
                                        {% if slug == 'deep-learning' %} text-pink-600/90 {% endif %}
                                        {% if slug == 'nlp' %} text-orange-600/90 {% endif %}
                                    {% endwith %}
                                ">
                                    <span><i class="fas fa-signal mr-1"></i> {{ topic.get_difficulty_display }}</span>
                                    <span><i class="fas fa-clock mr-1"></i> 10-15 min read</span>
                                </div>
                            </a>
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="text-center py-12">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">No Topics Yet</h3>
                            <p class="text-gray-600 mb-6">Topics for this category will be added soon.</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function toggleCategory(slug) {
    const subtopics = document.getElementById(slug + '-subtopics');
    const icon = document.getElementById(slug + '-icon');
    
    if (subtopics && icon) {
        subtopics.classList.toggle('hidden');
        icon.classList.toggle('rotate-180');
    }
}
</script>
{% endblock %} 