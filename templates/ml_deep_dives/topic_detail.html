{% extends 'base.html' %}

{% block title %}{{ topic.title }} - ML Deep Dives{% endblock %}

{% if topic.slug == 'math-linear-algebra' %}
{% block extra_css %}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        .hero-bg {
            background-color: #1a202c;
            background-image:
                radial-gradient(at 47% 33%, hsl(162.00, 77%, 40%) 0, transparent 59%),
                radial-gradient(at 82% 65%, hsl(218.00, 89%, 43%) 0, transparent 55%);
        }
        .la-body {
            font-family: 'Inter', sans-serif;
        }
        .matrix-cell {
            transition: all 0.2s ease-in-out;
        }
        .matrix-row:hover .matrix-cell,
        .matrix-col:hover .matrix-cell {
            background-color: #fbbf24; /* amber-300 */
            color: #1a202c;
            transform: scale(1.1);
        }
    </style>
{% endblock %}
{% endif %}

{% block content %}
<button id="expand-btn" class="hidden fixed top-24 left-4 z-30 bg-indigo-600 text-white h-12 w-12 items-center justify-center rounded-full shadow-xl hover:bg-indigo-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 animate-pulse-subtle">
    <i class="fas fa-bars fa-lg"></i>
</button>
<div class="bg-gray-50 {% if topic.slug == 'math-linear-algebra' %}la-body{% endif %}">
    <!-- Header Section with Curves -->
    <div class="relative bg-gradient-to-br from-indigo-800 via-purple-800 to-pink-800 text-white overflow-hidden">
        <div class="absolute inset-0">
            <div class="absolute top-0 left-0 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse"></div>
            <div class="absolute bottom-0 right-0 w-72 h-72 bg-yellow-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse" style="animation-delay: 2s;"></div>
        </div>
        <div class="relative z-10 max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <!-- Breadcrumbs -->
            <nav class="flex items-center space-x-2 text-sm text-purple-200 mb-6">
                <a href="{% url 'home' %}" class="hover:text-white transition-colors">Home</a>
                <i class="fas fa-chevron-right text-purple-300 fa-xs"></i>
                <a href="{% url 'ml_deep_dives:category_list' %}" class="hover:text-white transition-colors">ML Deep Dives</a>
                <i class="fas fa-chevron-right text-purple-300 fa-xs"></i>
                <a href="{{ topic.category.get_absolute_url }}" class="hover:text-white transition-colors">{{ topic.category.name }}</a>
                <i class="fas fa-chevron-right text-purple-300 fa-xs"></i>
                <span class="text-white font-semibold">{{ topic.title }}</span>
            </nav>
            
            <div class="flex flex-col md:flex-row items-start md:items-center">
                <div class="w-20 h-20 bg-white/10 backdrop-blur-sm rounded-2xl flex items-center justify-center mr-6 mb-4 md:mb-0 flex-shrink-0">
                    <i class="{{ topic.category.icon }} text-white text-3xl"></i>
                </div>
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold text-white">{{ topic.title }}</h1>
                    <p class="text-purple-200 text-xl mt-1">{{ topic.category.name }}</p>
                </div>
            </div>
        </div>
        <!-- Curved Bottom -->
        <div class="absolute bottom-0 left-0 right-0">
            <svg viewBox="0 0 1200 120" preserveAspectRatio="none" class="w-full h-20">
                <path d="M0,0 C300,120 900,120 1200,0 L1200,120 L0,120 Z" fill="#f9fafb"></path>
            </svg>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid lg:grid-cols-4 gap-8">
            <!-- Sidebar Navigation -->
            <div class="lg:col-span-1" id="sidebar-container">
                <div class="bg-white rounded-2xl shadow-lg p-6 sticky top-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="{{ topic.category.icon }} mr-3 
                                {% if topic.category.slug == 'math' %}text-green-600{% endif %}
                                {% if topic.category.slug == 'libraries' %}text-blue-600{% endif %}
                                {% if topic.category.slug == 'ml' %}text-purple-600{% endif %}
                                {% if topic.category.slug == 'deep-learning' %}text-pink-600{% endif %}
                                {% if topic.category.slug == 'nlp' %}text-orange-600{% endif %}
                            "></i>
                            <span class="truncate">{{ topic.category.name }}</span>
                        </h3>
                        <button id="collapse-btn" class="text-gray-400 hover:text-indigo-600 p-1 rounded-full hover:bg-gray-100 transition-colors" title="Collapse sidebar">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                    </div>
                    
                    <nav class="space-y-1">
                        {% for other_topic in topic.category.topics.all %}
                        <a href="{{ other_topic.get_absolute_url }}" 
                           class="block py-2 px-3 rounded-lg transition-all duration-300 flex items-center
                           {% if other_topic.slug == topic.slug %}
                               bg-indigo-100 text-indigo-800 font-semibold border-l-4 border-indigo-600
                           {% else %}
                               text-gray-600 hover:bg-gray-100 hover:text-gray-900
                           {% endif %}">
                            <span class="truncate">{{ other_topic.title }}</span>
                        </a>
                        {% endfor %}
                    </nav>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="lg:col-span-3" id="main-content-container">
                {% if topic.slug == 'math-linear-algebra' %}
                <div class="hero-bg text-white shadow-lg rounded-2xl p-8 md:p-12 mb-8">
                    <div class="text-center">
                        <h1 class="text-4xl md:text-5xl font-black leading-tight mb-4">Linear Algebra: The Secret Sauce of Machine Learning</h1>
                        <p class="text-lg md:text-xl text-gray-300 max-w-3xl mx-auto">
                            Admit it, the words "Linear Algebra" probably give you flashbacks to a class you thought you'd never need. You figured it was just for mathematicians and people who enjoy pain. Well, surprise! It turns out this stuff is the bedrock of AI, from your Netflix queue to self-driving cars. Without it, ML would just be... L.
                        </p>
                    </div>
                </div>
                {% endif %}

                <article class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <div class="p-8">
                        <!-- Summary -->
                        {% if topic.slug != 'math-linear-algebra' %}
                        <div class="p-6 mb-8 bg-gray-50 rounded-xl border border-gray-200">
                            <h2 class="text-2xl font-bold text-gray-800 mb-3">Summary</h2>
                            <p class="text-gray-700 leading-relaxed">{{ topic.summary }}</p>
                            <div class="mt-4 flex flex-wrap items-center gap-x-6 gap-y-2 text-sm text-gray-600">
                                <span class="flex items-center"><i class="fas fa-signal mr-2 text-indigo-500"></i>{{ topic.get_difficulty_display }}</span>
                                <span class="flex items-center"><i class="fas fa-calendar mr-2 text-indigo-500"></i>Updated {{ topic.updated_at|date:"M d, Y" }}</span>
                                <span class="flex items-center"><i class="fas fa-clock mr-2 text-indigo-500"></i>10-15 min read</span>
                            </div>
                            {% if topic.tags %}
                            <div class="mt-4 flex flex-wrap gap-2">
                                {% for tag in topic.get_tags_list %}
                                <span class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-xs font-medium">{{ tag }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                        {% endif %}

                        <!-- Main Content -->
                        {% if topic.slug == 'math-linear-algebra' %}
                        <div class="prose prose-lg max-w-none">
                            <section class="mb-16">
                                <h2 class="text-3xl font-bold mb-4">So, Why Should You Care?</h2>
                                <p>
                                    Think of Machine Learning as building with LEGOs. You can follow the instructions and build a cool spaceship, but if you want to design your own Death Star, you need to understand the physics of how the bricks connect. Linear Algebra is that physics. It's the language we use to describe and manipulate the massive datasets that fuel modern AI.
                                </p>
                                <p>
                                    For example:
                                </p>
                                <ul class="list-disc list-outside ml-5 space-y-4">
                                    <li><strong>Netflix Recommendations:</strong> Ever wonder how Netflix knows you'll love a weird documentary about competitive cheese rolling? It uses a powerful Linear Algebra technique called <a href="#svd" class="text-indigo-600 hover:underline font-semibold">Singular Value Decomposition (SVD)</a> to analyze a giant matrix of user ratings. Your taste is literally a vector in a high-dimensional space!</li>
                                    <li><strong>Image Recognition:</strong> When your phone recognizes your face, it's converting your picture into a matrix of pixel values and performing a series of matrix multiplications. You're not a face; you're a math problem. A very beautiful math problem, of course.</li>
                                    <li><strong>Natural Language Processing (NLP):</strong> How does Google Translate work? By representing words and sentences as <a href="#vectors" class="text-indigo-600 hover:underline font-semibold">vectors</a> in a process called "word embedding." The relationships between words are captured by the distances and angles between these vectors.</li>
                                </ul>
                                <p>
                                    Ready to peek behind the curtain? Let's dive in. Don't worry, we'll keep the math interesting. Mostly.
                                </p>
                            </section>
                
                            <!-- Section 1: The Building Blocks -->
                            <section id="vectors" class="mb-16">
                                <h2 class="text-3xl font-bold mb-4">The Building Blocks: Scalars, Vectors, and Matrices</h2>
                                <p>Let's start with the absolute basics. These are the nouns of our new language.</p>
                                <div class="grid md:grid-cols-3 gap-8 not-prose">
                                    <div class="bg-gray-100 p-6 rounded-lg">
                                        <h3 class="text-xl font-semibold mb-2">Scalar</h3>
                                        <p>A single, lonely number. Like the temperature, your age, or the number of times you've promised to learn Linear Algebra. Example: <span class="font-bold text-lg">\(7\)</span></p>
                                    </div>
                                    <div class="bg-gray-100 p-6 rounded-lg">
                                        <h3 class="text-xl font-semibold mb-2">Vector</h3>
                                        <p>An ordered list of numbers. Think of it as a point in space or a set of features. For example, a fish could be represented by a vector: [weight, length, color].</p>
                                        <p class="font-mono text-center text-lg p-2 bg-white rounded">[ 1.2, 15.5, 0.8 ]</p>
                                    </div>
                                    <div class="bg-gray-100 p-6 rounded-lg">
                                        <h3 class="text-xl font-semibold mb-2">Matrix</h3>
                                        <p>A grid of numbers, or a list of vectors. This is where the magic happens. A whole dataset of fish can be a matrix, where each row is one fish.</p>
                                    </div>
                                </div>
                                <div class="mt-8 p-6 bg-gray-50 rounded-lg shadow-inner flex justify-center items-center flex-col not-prose">
                                    <h4 class="text-lg font-semibold mb-2">Interactive Matrix Operations</h4>
                                    <p class="text-sm text-gray-500 mb-6">Experiment with fundamental matrix operations in real-time.</p>

                                    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg mt-8 not-prose">
                                        <h4 class="text-xl font-bold text-gray-800 mb-4 text-center">Interactive Matrix Operations</h4>
                                        <p class="text-sm text-gray-500 mb-6 text-center">Experiment with fundamental matrix operations in real-time.</p>

                                        <!-- Control Panel -->
                                        <div class="bg-gray-100 p-4 rounded-lg mb-6 flex flex-wrap items-center justify-center gap-4 md:gap-8">
                                            <!-- Scalar Multiplication -->
                                            <div class="flex items-center gap-3">
                                                <label for="scalar-input" class="font-semibold text-gray-700">Scalar:</label>
                                                <input type="number" id="scalar-input" value="2" class="w-20 border-gray-300 rounded-md shadow-sm text-center focus:ring-indigo-500 focus:border-indigo-500">
                                                <button id="scalar-multiply-btn" class="px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 font-semibold text-sm flex items-center gap-2 transition-colors">
                                                    <i class="fas fa-times"></i> Multiply
                                                </button>
                                            </div>

                                            <div class="h-8 border-l border-gray-300 hidden md:block"></div>

                                            <!-- Transpose -->
                                            <div class="flex items-center">
                                                <button id="transpose-btn" class="px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 font-semibold text-sm flex items-center gap-2 transition-colors">
                                                    <i class="fas fa-retweet"></i> Transpose
                                                </button>
                                            </div>
                                            
                                            <div class="h-8 border-l border-gray-300 hidden md:block"></div>

                                            <!-- Reset -->
                                            <div class="flex items-center">
                                                <button id="reset-matrix-btn" class="px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 font-semibold text-sm flex items-center gap-2 transition-colors">
                                                    <i class="fas fa-undo"></i> Reset
                                                </button>
                                            </div>
                                        </div>

                                        <!-- The Matrix -->
                                        <div class="flex justify-center">
                                            <div id="interactive-matrix" class="font-mono text-sm md:text-base p-4 border border-gray-200 rounded-lg bg-gray-50 shadow-inner inline-block"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            
                            <!-- Section 2: The Dot Product -->
                            <section class="mb-16">
                                <h2 class="text-3xl font-bold mb-4">Vector Operations: The Dot Product, a.k.a. "The Similarity Meter"</h2>
                                <p>
                                    The dot product is one of the most fundamental operations in all of ML. On the surface, it's a simple calculation, but its true power lies in its geometric meaning: it tells us how "similar" two vectors are.
                                </p>
                                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg mt-8 not-prose">
                                    <h4 class="text-xl font-bold text-gray-800 mb-2 text-center">Interactive Dot Product</h4>
                                    <p class="text-sm text-gray-500 mb-4 text-center">Drag the vector tips or enter values to see their relationship.</p>
                                    
                                    <div class="my-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg text-center">
                                        <p class="text-lg text-indigo-800 font-semibold">
                                            \(a \cdot b = \|a\| \|b\| \cos(\theta)\)
                                        </p>
                                    </div>

                                    <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                                        <!-- Visualization -->
                                        <div id="dot-product-viz" class="w-full h-80 xl:col-span-2 bg-gray-50 rounded-lg shadow-inner cursor-pointer"></div>
                                        
                                        <!-- Controls and Results -->
                                        <div class="flex flex-col justify-center gap-4">
                                            <div class="flex items-center gap-3">
                                                <div class="w-5 h-5 rounded-full bg-blue-500"></div>
                                                <label class="font-bold text-lg text-gray-700">a = </label>
                                                <span class="font-mono text-lg">[</span>
                                                <input type="number" step="0.1" id="vec-a-x" value="3" class="w-16 text-center border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                                <span class="font-mono text-lg">,</span>
                                                <input type="number" step="0.1" id="vec-a-y" value="2" class="w-16 text-center border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                                <span class="font-mono text-lg">]</span>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <div class="w-5 h-5 rounded-full bg-red-500"></div>
                                                <label class="font-bold text-lg text-gray-700">b = </label>
                                                <span class="font-mono text-lg">[</span>
                                                <input type="number" step="0.1" id="vec-b-x" value="1" class="w-16 text-center border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                                <span class="font-mono text-lg">,</span>
                                                <input type="number" step="0.1" id="vec-b-y" value="4" class="w-16 text-center border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                                <span class="font-mono text-lg">]</span>
                                            </div>
                                            <div class="mt-4 text-center bg-gray-100 p-4 rounded-lg">
                                                <p class="font-mono text-xl font-semibold">a Â· b = <span id="dot-product-val">11.00</span></p>
                                                <p class="text-sm text-gray-600 mt-2">Angle = <strong id="angle-val">40.6Â°</strong></p>
                                            </div>
                                            <div id="dot-product-explanation" class="text-center text-sm text-gray-700 h-10 flex items-center justify-center"></div>
                                        </div>
                                    </div>
                                </div>

                                <p class="mt-8">
                                    That \(\cos(\theta)\) is the key. It tells us about the angle (\(\theta\)) between the two vectors.
                                </p>
                                <ul class="list-disc list-inside space-y-2">
                                    <li>If the vectors point in the same direction, \(\cos(\theta) = 1\), and the dot product is at its max. They are very similar!</li>
                                    <li>If the vectors are perpendicular, \(\cos(\theta) = 0\), and the dot product is zero. They have nothing in common, like a cat and a vacuum cleaner.</li>
                                    <li>If they point in opposite directions, \(\cos(\theta) = -1\), and the dot product is negative. They are "anti-similar."</li>
                                </ul>
                                <p>
                                    <strong>ML Connection:</strong> This is used everywhere! Neural networks are essentially a series of dot products. In NLP, the dot product between word vectors measures semantic similarity. "King" and "Queen" will have a high dot product; "King" and "Cabbage" will not.
                                </p>
                            </section>
                
                            <!-- Section 3: Lines, Planes, and Classification -->
                            <section class="mb-16">
                                <h2 class="text-3xl font-bold mb-4">Lines & Planes: The Great Dividers</h2>
                                <p>
                                    Remember your notes about classifying fish? This is where it gets real. Many machine learning models, at their core, are just trying to find a line (in 2D), a plane (in 3D), or a "hyperplane" (in more dimensions) to separate data points into different classes. This is the essence of a <strong>linear classifier</strong>.
                                </p>
                                <p>
                                    The equation of a plane is \(w_1x_1 + w_2x_2 + w_3x_3 + b = 0\). This can be written beautifully using the dot product: \(\vec{w} \cdot \vec{x} + b = 0\). The vector \(\vec{w}\) is the "normal vector"â€”it's perpendicular to the plane and defines its orientation.
                                </p>
                                <p>
                                    A model like a <strong>Support Vector Machine (SVM)</strong> is obsessed with finding the perfect hyperplane that has the maximum possible margin (distance) between the different classes. It's like a bouncer at a club creating the biggest possible "no-man's-land" between two rival groups to prevent a fight.
                                </p>
                                <div class="bg-gray-50 p-6 rounded-xl shadow-inner mt-8 not-prose relative">
                                    <h4 class="text-xl font-semibold mb-2 text-center">Interactive Vibe Check</h4>
                                    <p class="text-sm text-gray-600 mb-4 text-center">
                                        At a trendy coffee shop, can you separate the <strong>Artisanal Hipsters (ðŸ¥¸)</strong> from the <strong>Silicon Valley Techies (ðŸš€)</strong>?<br>
                                        <strong>Your mission:</strong> Drag the line to find the optimal "Vibe" separator!
                                    </p>
                                    <div id="interactive-classifier" class="w-full h-96 cursor-pointer overflow-hidden rounded-lg bg-white"></div>
                                </div>
                            </section>
                            
                            <!-- Section 4: Eigen-stuff -->
                            <section id="eigen" class="mb-16">
                                <h2 class="text-3xl font-bold mb-4">Eigen-stuff: What's So Special?</h2>
                                <p>
                                    "Eigen" is German for "own" or "characteristic." Eigenvectors and eigenvalues are the characteristic properties of a matrix. When you apply a matrix (a transformation like squishing, stretching, or rotating) to one of its eigenvectors, something amazing happens: the vector's direction doesn't change! It only gets scaled (stretched or shrunk).
                                </p>
                                <p class="text-center bg-gray-100 p-4 rounded-lg font-mono text-lg not-prose">
                                    \[A\vec{v} = \lambda\vec{v}\]
                                </p>
                                <p>
                                    Here, \(A\) is the matrix, \(\vec{v}\) is the mighty eigenvector, and \(\lambda\) (lambda) is the eigenvalueâ€”the factor by which the eigenvector is scaled.
                                </p>
                                <div id="pca-visualization" class="w-full h-96 my-6 bg-gray-50 rounded-xl shadow-inner cursor-pointer"></div>
                                <p>
                                    <strong>ML Connection: Principal Component Analysis (PCA).</strong> This is a powerhouse technique for dimensionality reduction. Imagine your data has 100 features (100 dimensions). It's impossible to visualize and slow to process. PCA uses eigenvectors to find the "principal components"â€”the directions in your data where the variance is highest. By keeping only the top few principal components (the eigenvectors with the largest eigenvalues), you can squish your data down to 2 or 3 dimensions while losing as little information as possible. It's like creating a really good summary of a book.
                                </p>
                            </section>
                            
                            <!-- Section 5: SVD -->
                            <section id="svd" class="mb-16">
                                <h2 class="text-3xl font-bold mb-4">SVD: The Swiss Army Knife of Linear Algebra</h2>
                                <p>
                                    Singular Value Decomposition (SVD) is the final boss of many linear algebra courses, but it's incredibly useful. It states that any matrix \(A\) can be factored into three other matrices:
                                </p>
                                <p class="text-center bg-gray-100 p-4 rounded-lg font-mono text-lg not-prose">
                                    \[A = U \Sigma V^T\]
                                </p>
                                <ul class="list-disc list-inside space-y-2">
                                    <li>\(U\): A matrix of "left singular vectors" (describes the axes of the output space).</li>
                                    <li>\(\Sigma\) (Sigma): A diagonal matrix of "singular values." These are similar to eigenvalues and tell you the "importance" of each dimension.</li>
                                    <li>\(V^T\): The transpose of a matrix of "right singular vectors" (describes the axes of the input space).</li>
                                </ul>
                                <div id="svd-visualization" class="w-full my-6 flex justify-center items-center p-4 bg-gray-50 rounded-xl shadow-inner"></div>
                                <p>
                                    <strong>ML Connection: Recommendation Engines & More.</strong> Remember Netflix? Let \(A\) be a huge matrix where rows are users and columns are movies. Most entries are empty because no one can watch every movie. SVD is magical because it can "fill in the blanks." By taking the SVD of this matrix and then recreating it using only the most important singular values (a process called low-rank approximation), we get a "denoised" version of the original matrix. The new values in the once-empty cells are our predictions for what rating a user would give a movie! This same principle is used for image compression and topic modeling in NLP.
                                </p>
                            </section>
                
                            <!-- Conclusion -->
                            <section>
                                <h2 class="text-3xl font-bold mb-4">The Grand Finale</h2>
                                <p>
                                    So there you have it. Linear Algebra isn't just a bunch of abstract rules; it's the powerful, elegant engine driving the most exciting technology of our time. From simple lines to complex decompositions, these concepts give us the tools to find patterns, make predictions, and teach machines to learn.
                                </p>
                                <p>
                                    The next time your phone unlocks with your face or a chatbot understands your question, give a little nod to the humble vector and the mighty matrix. They're the unsung heroes of the AI revolution. Now go forth and multiply (matrices, that is).
                                </p>
                            </section>
                        </div>
                        {% else %}
                        <div class="prose prose-indigo prose-lg max-w-none">
                            {% if topic.content and topic.content != "Content coming soon..." %}
                                {{ topic.content|linebreaks }}
                            {% else %}
                                <!-- Placeholder Content -->
                                <div class="text-center py-16">
                                    <div class="w-24 h-24 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                        <i class="fas fa-tools text-indigo-600 text-3xl"></i>
                                    </div>
                                    <h2 class="text-3xl font-bold text-gray-800 mb-4">Content Coming Soon</h2>
                                    <p class="text-gray-700 max-w-md mx-auto mb-8">
                                        We're working hard to bring you comprehensive content for this topic. Check back soon for detailed explanations, code examples, and interview-focused material.
                                    </p>
                                </div>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </article>

                <!-- Navigation -->
                <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% with prev_topic=topic.get_previous_by_order %}
                    {% if prev_topic %}
                    <a href="{{ prev_topic.get_absolute_url }}" 
                       class="group block p-6 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 text-left">
                        <div class="flex items-center text-sm text-gray-500 mb-2">
                            <i class="fas fa-arrow-left mr-2"></i> Previous
                        </div>
                        <p class="font-semibold text-lg text-gray-800 group-hover:text-indigo-600 transition-colors">{{ prev_topic.title }}</p>
                    </a>
                    {% else %}
                    <div></div>
                    {% endif %}
                    {% endwith %}
                    
                    {% with next_topic=topic.get_next_by_order %}
                    {% if next_topic %}
                    <a href="{{ next_topic.get_absolute_url }}" 
                       class="group block p-6 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 text-right">
                       <div class="flex items-center justify-end text-sm text-gray-500 mb-2">
                           Next <i class="fas fa-arrow-right ml-2"></i>
                       </div>
                       <p class="font-semibold text-lg text-gray-800 group-hover:text-indigo-600 transition-colors">{{ next_topic.title }}</p>
                    </a>
                    {% endif %}
                    {% endwith %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% if topic.slug == 'math-linear-algebra' %}
{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Interactive Matrix Script
        const matrixContainer = document.getElementById('interactive-matrix');
        const scalarInput = document.getElementById('scalar-input');
        const scalarMultiplyBtn = document.getElementById('scalar-multiply-btn');
        const transposeBtn = document.getElementById('transpose-btn');
        const resetBtn = document.getElementById('reset-matrix-btn');

        if (matrixContainer) {
            let originalMatrixData = [
                [1.2, 15.5, 0.8],
                [2.5, 22.1, 0.2],
                [0.8, 12.0, 0.9],
                [3.1, 25.3, 0.1]
            ];
            let currentMatrixData = JSON.parse(JSON.stringify(originalMatrixData));

            const renderMatrix = (data) => {
                let matrixHTML = '<div class="flex flex-col gap-3">';
                data.forEach((rowData, i) => {
                    matrixHTML += `<div class="flex gap-3 matrix-row justify-center" data-row="${i}">`;
                    rowData.forEach((cellData, j) => {
                        matrixHTML += `<div class="matrix-cell-wrapper" data-row="${i}" data-col="${j}">
                                        <div class="bg-white border border-gray-300 rounded-md w-24 h-14 flex items-center justify-center transition-all duration-200">${cellData.toFixed(1)}</div>
                                      </div>`;
                    });
                    matrixHTML += '</div>';
                });
                matrixHTML += '</div>';
                matrixContainer.innerHTML = matrixHTML;
                addHoverListeners();
            };

            const addHoverListeners = () => {
                const cells = matrixContainer.querySelectorAll('.matrix-cell-wrapper');
                cells.forEach(cell => {
                    cell.addEventListener('mouseover', () => {
                        const row = cell.dataset.row;
                        const col = cell.dataset.col;
                        document.querySelectorAll(`.matrix-cell-wrapper[data-row="${row}"] > div`).forEach(el => el.classList.add('bg-amber-300', 'scale-105', 'shadow-lg'));
                        document.querySelectorAll(`.matrix-cell-wrapper[data-col="${col}"] > div`).forEach(el => el.classList.add('bg-amber-300', 'scale-105', 'shadow-lg'));
                    });
                    cell.addEventListener('mouseout', () => {
                        document.querySelectorAll('.matrix-cell-wrapper > div').forEach(el => el.classList.remove('bg-amber-300', 'scale-105', 'shadow-lg'));
                    });
                });
            };

            scalarMultiplyBtn.addEventListener('click', () => {
                const scalar = parseFloat(scalarInput.value) || 0;
                currentMatrixData = currentMatrixData.map(row => row.map(cell => cell * scalar));
                renderMatrix(currentMatrixData);
            });

            transposeBtn.addEventListener('click', () => {
                if (currentMatrixData.length === 0 || currentMatrixData[0].length === 0) return;
                currentMatrixData = currentMatrixData[0].map((_, colIndex) => currentMatrixData.map(row => row[colIndex]));
                renderMatrix(currentMatrixData);
            });

            resetBtn.addEventListener('click', () => {
                currentMatrixData = JSON.parse(JSON.stringify(originalMatrixData));
                renderMatrix(currentMatrixData);
            });
            
            // Initial render
            renderMatrix(currentMatrixData);
        }

        // Dot Product Visualization
        const dotProductContainer = d3.select("#dot-product-viz");
        if(dotProductContainer.node()) {
            const inputs = {
                ax: document.getElementById('vec-a-x'), ay: document.getElementById('vec-a-y'),
                bx: document.getElementById('vec-b-x'), by: document.getElementById('vec-b-y'),
            };
            const resultVal = document.getElementById('dot-product-val');
            const angleVal = document.getElementById('angle-val');
            const explanationEl = document.getElementById('dot-product-explanation');

            const width = dotProductContainer.node().getBoundingClientRect().width;
            const height = 320;
            const margin = {top: 20, right: 20, bottom: 20, left: 20};
            const innerWidth = width - margin.left - margin.right;
            const innerHeight = height - margin.top - margin.bottom;

            const svg = dotProductContainer.append("svg")
                .attr("width", "100%").attr("height", "100%")
                .attr("viewBox", `0 0 ${width} ${height}`);
            
            const g = svg.append("g").attr("transform", `translate(${margin.left}, ${margin.top})`);
            
            const maxVal = 6;
            const xScale = d3.scaleLinear().domain([-maxVal, maxVal]).range([0, innerWidth]);
            const yScale = d3.scaleLinear().domain([-maxVal, maxVal]).range([innerHeight, 0]);
            const center = { x: xScale(0), y: yScale(0) };

            g.append("g").call(d3.axisBottom(xScale).ticks(10).tickFormat("")).attr("transform", `translate(0, ${center.y})`).select(".domain").attr("stroke", "#e2e8f0");
            g.append("g").call(d3.axisLeft(yScale).ticks(10).tickFormat("")).attr("transform", `translate(${center.x}, 0)`).select(".domain").attr("stroke", "#e2e8f0");
            g.selectAll(".tick line").attr("stroke", "#e2e8f0");

            const vectorGroup = g.append("g");
            const angleGroup = g.append("g");

            const updateVisualization = () => {
                const vec = {
                    a: { x: +inputs.ax.value, y: +inputs.ay.value },
                    b: { x: +inputs.bx.value, y: +inputs.by.value }
                };

                const dotProduct = vec.a.x * vec.b.x + vec.a.y * vec.b.y;
                const magA = Math.sqrt(vec.a.x**2 + vec.a.y**2);
                const magB = Math.sqrt(vec.b.x**2 + vec.b.y**2);
                const angleRad = (magA * magB === 0) ? 0 : Math.acos(dotProduct / (magA * magB));
                const angleDeg = isNaN(angleRad) ? 0 : angleRad * (180 / Math.PI);

                resultVal.textContent = dotProduct.toFixed(2);
                angleVal.textContent = `${angleDeg.toFixed(1)}Â°`;
                
                let explanation = "";
                let cosTheta = dotProduct / (magA * magB);
                if (isNaN(cosTheta)) cosTheta = 0;

                if (cosTheta > 0.95) explanation = "The vectors are strongly aligned.";
                else if (cosTheta < -0.95) explanation = "The vectors point in opposite directions.";
                else if (Math.abs(cosTheta) < 0.1) explanation = "The vectors are nearly orthogonal (unrelated).";
                explanationEl.textContent = explanation;

                angleGroup.selectAll("*").remove();
                // Only draw arc if vectors are non-zero
                if (magA > 0 && magB > 0) {
                    const angleA_viz = Math.atan2(-vec.a.y, vec.a.x);
                    // 2D cross-product to find the sign of the angle
                    const cross_product = vec.a.x * vec.b.y - vec.a.y * vec.b.x;
                    // SVG y-axis is inverted, so rotation direction is flipped
                    const sweep_direction = cross_product === 0 ? 1 : -Math.sign(cross_product);

                    const arc = d3.arc().innerRadius(0).outerRadius(30)
                        .startAngle(angleA_viz)
                        .endAngle(angleA_viz + sweep_direction * angleRad);
                    
                    angleGroup.append("path").attr("d", arc)
                        .attr("transform", `translate(${center.x}, ${center.y})`)
                        .attr("fill", "#f59e0b").attr("opacity", 0.5);
                }

                const vectors = [
                    { ...vec.a, color: '#3b82f6', id: 'a' },
                    { ...vec.b, color: '#ef4444', id: 'b' }
                ];

                const vectorLines = vectorGroup.selectAll("line.vector")
                    .data(vectors, d => d.id);
                
                vectorLines.enter().append("line")
                    .attr("class", "vector")
                    .attr("x1", center.x).attr("y1", center.y)
                    .attr("marker-end", d => `url(#arrow-${d.id})`)
                    .merge(vectorLines)
                    .transition().duration(200)
                    .attr("x2", d => xScale(d.x))
                    .attr("y2", d => yScale(d.y))
                    .attr("stroke", d => d.color).attr("stroke-width", 4);
                
                const handles = vectorGroup.selectAll("circle.handle")
                    .data(vectors, d => d.id);

                handles.enter().append("circle")
                    .attr("class", "handle")
                    .attr("r", 10).style("cursor", "pointer").attr("fill", d => d.color)
                    .call(d3.drag()
                        .on("drag", function(event, d) {
                            const newX = xScale.invert(event.x);
                            const newY = yScale.invert(event.y);
                            inputs[`${d.id}x`].value = newX.toFixed(1);
                            inputs[`${d.id}y`].value = newY.toFixed(1);
                            updateVisualization();
                        })
                    )
                    .merge(handles)
                    .transition().duration(200)
                    .attr("cx", d => xScale(d.x))
                    .attr("cy", d => yScale(d.y));
            };

            svg.append("defs").selectAll("marker")
                .data(['a', 'b']).enter()
                .append("marker")
                .attr("id", d => `arrow-${d}`)
                .attr("viewBox", "0 -5 10 10").attr("refX", 10).attr("refY", 0)
                .attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto")
                .append("path").attr("d", "M0,-5L10,0L0,5")
                .attr("fill", d => d === 'a' ? '#3b82f6' : '#ef4444');

            Object.values(inputs).forEach(input => input.addEventListener('input', updateVisualization));
            updateVisualization();
        }

        // Interactive Classifier Script
        const classifierContainer = d3.select("#interactive-classifier");
        if (classifierContainer.node()) {
            const renderClassifier = () => {
                classifierContainer.selectAll("*").remove();
        
                const width = classifierContainer.node().getBoundingClientRect().width;
                const height = 400;
                const margin = { top: 20, right: 30, bottom: 50, left: 60 };
                const innerWidth = width - margin.left - margin.right;
                const innerHeight = height - margin.top - margin.bottom;
        
                const svg = classifierContainer.append("svg")
                    .attr("width", "100%")
                    .attr("height", "100%")
                    .attr("viewBox", `0 0 ${width} ${height}`)
                    .style("font-family", "Inter, sans-serif");
        
                const g = svg.append("g")
                    .attr("transform", `translate(${margin.left}, ${margin.top})`);
        
                svg.append("text")
                    .attr("class", "font-semibold text-sm")
                    .attr("text-anchor", "middle")
                    .attr("x", width / 2)
                    .attr("y", height - 10)
                    .text("Startup Pitch Enthusiasm");
        
                svg.append("text")
                    .attr("class", "font-semibold text-sm")
                    .attr("text-anchor", "middle")
                    .attr("transform", `translate(20, ${height/2}) rotate(-90)`)
                    .text("Love for Obscure Indie Music");
        
                const hipsters = d3.range(30).map(() => ({ x: d3.randomNormal(2.5, 0.9)(), y: d3.randomNormal(7.5, 0.9)(), class: 0, icon: "ðŸ¥¸" }));
                const techies = d3.range(30).map(() => ({ x: d3.randomNormal(7.5, 0.9)(), y: d3.randomNormal(2.5, 0.9)(), class: 1, icon: "ðŸš€" }));
                const data = [...hipsters, ...techies].filter(d => d.x >= 0 && d.x <=10 && d.y >= 0 && d.y <= 10);
        
                const xScale = d3.scaleLinear().domain([0, 10]).range([0, innerWidth]);
                const yScale = d3.scaleLinear().domain([0, 10]).range([innerHeight, 0]);
        
                g.append("g").call(d3.axisBottom(xScale).ticks(5).tickSize(-innerHeight)).attr("transform", `translate(0, ${innerHeight})`).select(".domain").remove();
                g.append("g").call(d3.axisLeft(yScale).ticks(5).tickSize(-innerWidth)).select(".domain").remove();
                g.selectAll(".tick line").attr("stroke", "#e5e7eb");
                g.selectAll(".tick text").attr("fill", "#6b7280");
        
                const tooltip = d3.select("body").append("div")
                    .attr("class", "d3-tooltip")
                    .style("position", "absolute")
                    .style("z-index", "10")
                    .style("visibility", "hidden")
                    .style("background", "rgba(0,0,0,0.75)")
                    .style("color", "#fff")
                    .style("padding", "8px 12px")
                    .style("border-radius", "6px")
                    .style("font-size", "12px");

                g.selectAll("text.emoji")
                    .data(data)
                    .enter().append("text")
                    .attr("class", "emoji")
                    .attr("x", d => xScale(d.x))
                    .attr("y", d => yScale(d.y))
                    .attr("text-anchor", "middle")
                    .attr("font-size", "24px")
                    .style("cursor", "pointer")
                    .text(d => d.icon)
                    .on("mouseover", function(event, d) {
                        d3.select(this).transition().duration(200).attr("font-size", "32px");
                        tooltip.html(`Indie Love: ${d.y.toFixed(1)}<br>Pitch Zeal: ${d.x.toFixed(1)}`);
                        return tooltip.style("visibility", "visible");
                    })
                    .on("mousemove", function(event) {
                        return tooltip.style("top", (event.pageY - 10) + "px").style("left", (event.pageX + 10) + "px");
                    })
                    .on("mouseout", function() {
                        d3.select(this).transition().duration(200).attr("font-size", "24px");
                        return tooltip.style("visibility", "hidden");
                    });
                
                const line = g.append("line").style("stroke", "#1a202c").style("stroke-width", 3).attr("stroke-linecap", "round");
                const handle = g.append("circle").attr("r", 10).attr("fill", "#6366f1").style("cursor", "move")
                    .on("mouseover", function() { d3.select(this).transition().duration(200).attr("r", 12); })
                    .on("mouseout", function() { d3.select(this).transition().duration(200).attr("r", 10); });
        
                let angle = -Math.PI / 4;
        
                function updateLine(newAngle) {
                    angle = newAngle;
                    const lineLength = Math.max(width, height) * 2;
                    const midX = xScale(5);
                    const midY = yScale(5);
        
                    line.attr("x1", midX + lineLength * Math.cos(angle)).attr("y1", midY + lineLength * Math.sin(angle))
                        .attr("x2", midX - lineLength * Math.cos(angle)).attr("y2", midY - lineLength * Math.sin(angle));
        
                    handle.attr("cx", midX + (innerHeight / 3.5) * Math.cos(angle + Math.PI/2))
                          .attr("cy", midY + (innerHeight / 3.5) * Math.sin(angle + Math.PI/2));
                }
        
                const drag = d3.drag().on("drag", function(event) {
                    const midX = xScale(5);
                    const midY = yScale(5);
                    const newAngle = Math.atan2(event.y - midY, event.x - midX) - Math.PI / 2;
                    updateLine(newAngle);
                });
                
                handle.call(drag);
                updateLine(angle);
            }
            renderClassifier();
        
            window.addEventListener('resize', () => {
                const classifierNode = classifierContainer.node();
                if (classifierNode && classifierNode.offsetParent !== null) {
                    renderClassifier();
                }
            });
             // Cleanup tooltip on navigation
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.removedNodes) {
                        mutation.removedNodes.forEach((node) => {
                            if (node === classifierContainer.node()) {
                                d3.select(".d3-tooltip").remove();
                                observer.disconnect();
                            }
                        });
                    }
                });
            });
            observer.observe(classifierContainer.node().parentNode, { childList: true });
        }

        // PCA Visualization
        const pcaContainer = d3.select("#pca-visualization");
        if (pcaContainer.node()) {
            const renderPCA = () => {
                pcaContainer.selectAll("*").remove();
                const width = pcaContainer.node().getBoundingClientRect().width;
                const height = pcaContainer.node().getBoundingClientRect().height;
                const margin = {top: 20, right: 20, bottom: 30, left: 40};
                const innerWidth = width - margin.left - margin.right;
                const innerHeight = height - margin.top - margin.bottom;

                const svg = pcaContainer.append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("viewBox", `0 0 ${width} ${height}`);

                const g = svg.append("g")
                    .attr("transform", `translate(${margin.left},${margin.top})`);

                const n = 150;
                const data = d3.range(n).map(() => {
                    let x = d3.randomNormal(0, 1)();
                    let y = d3.randomNormal(0, 0.4)();
                    let angle = -Math.PI / 4;
                    return {
                        x: x * Math.cos(angle) - y * Math.sin(angle),
                        y: x * Math.sin(angle) + y * Math.cos(angle)
                    };
                });
                
                const xScale = d3.scaleLinear().domain(d3.extent(data, d => d.x)).range([0, innerWidth]);
                const yScale = d3.scaleLinear().domain(d3.extent(data, d => d.y)).range([innerHeight, 0]);

                g.selectAll("circle")
                    .data(data)
                    .enter().append("circle")
                    .attr("cx", d => xScale(d.x))
                    .attr("cy", d => yScale(d.y))
                    .attr("r", 3)
                    .attr("fill", "black")
                    .attr("opacity", 0.3);

                const center_x = xScale(0);
                const center_y = yScale(0);

                // PC1
                g.append("line")
                    .attr("x1", center_x - innerWidth/2.5).attr("y1", center_y + innerWidth/2.5)
                    .attr("x2", center_x + innerWidth/2.5).attr("y2", center_y - innerWidth/2.5)
                    .attr("stroke", "#ef4444").attr("stroke-width", 3);
                // PC2
                g.append("line")
                    .attr("x1", center_x - innerHeight/1.5).attr("y1", center_y - innerHeight/1.5)
                    .attr("x2", center_x + innerHeight/1.5).attr("y2", center_y + innerHeight/1.5)
                    .attr("stroke", "#3b82f6").attr("stroke-width", 3);
            };
            renderPCA();
            window.addEventListener('resize', renderPCA);
        }

        // SVD Visualization
        const svdContainer = d3.select("#svd-visualization");
        if(svdContainer.node()) {
            const width = 500;
            const height = 150;
            const svg = svdContainer.append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", `0 0 ${width} ${height}`);
            
            // Matrix A
            svg.append("rect").attr("x", 0).attr("y", 25).attr("width", 100).attr("height", 100).attr("fill", "#6366f1");
            svg.append("text").text("A").attr("x", 50).attr("y", 80).attr("text-anchor", "middle").attr("fill", "white").attr("font-size", "2em");
            
            // Equals
            svg.append("text").text("=").attr("x", 120).attr("y", 80).attr("text-anchor", "middle").attr("font-size", "2em");

            // Matrix U
            svg.append("rect").attr("x", 140).attr("y", 25).attr("width", 100).attr("height", 100).attr("fill", "#3b82f6");
            svg.append("text").text("U").attr("x", 190).attr("y", 80).attr("text-anchor", "middle").attr("fill", "white").attr("font-size", "2em");
            
            // Sigma
            svg.append("rect").attr("x", 260).attr("y", 25).attr("width", 100).attr("height", 100).attr("fill", "#10b981");
            d3.range(3).forEach(i => {
                svg.append("rect").attr("x", 260 + i * 33.3).attr("y", 25 + i * 33.3).attr("width", 33.3).attr("height", 33.3).attr("fill", "#a7f3d0");
            });
            svg.append("text").text("Î£").attr("x", 310).attr("y", 80).attr("text-anchor", "middle").attr("fill", "white").attr("font-size", "2em");

            // V^T
            svg.append("rect").attr("x", 380).attr("y", 25).attr("width", 100).attr("height", 100).attr("fill", "#ef4444");
            svg.append("text").html("V&#x1d40;").attr("x", 430).attr("y", 80).attr("text-anchor", "middle").attr("fill", "white").attr("font-size", "2em");
        }
    });
</script>
{% endblock %}
{% endif %}

{% block page_js %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('sidebar-container');
    const mainContent = document.getElementById('main-content-container');
    const collapseBtn = document.getElementById('collapse-btn');
    const expandBtn = document.getElementById('expand-btn');

    if (!sidebar || !mainContent || !collapseBtn || !expandBtn) {
        return; 
    }

    const collapse = () => {
        sidebar.classList.add('lg:hidden');
        mainContent.classList.remove('lg:col-span-3');
        mainContent.classList.add('lg:col-span-4');
        expandBtn.classList.remove('hidden');
        expandBtn.classList.add('flex');
        localStorage.setItem('sidebarStatus', 'collapsed');
    };

    const expand = () => {
        sidebar.classList.remove('lg:hidden');
        mainContent.classList.add('lg:col-span-3');
        mainContent.classList.remove('lg:col-span-4');
        expandBtn.classList.add('hidden');
        expandBtn.classList.remove('flex');
        localStorage.setItem('sidebarStatus', 'expanded');
    };

    collapseBtn.addEventListener('click', collapse);
    expandBtn.addEventListener('click', expand);

    if (localStorage.getItem('sidebarStatus') === 'collapsed') {
        collapse();
    }
});
</script>
{% endblock %}